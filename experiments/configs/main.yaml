# RAG Second Brain v16 - Main Experiment Configuration

experiment:
  name: "rag-second-brain-v16"
  seed: 42
  seeds_for_ci: [42, 123, 456, 789, 1000]

data:
  dataset: "hotpotqa"
  subset: "distractor"
  train_split: "train[:80%]"
  val_split: "train[80%:90%]"
  test_split: "validation"

retrieval:
  dense:
    model: "intfloat/e5-large-v2"
    batch_size: 32
    normalize: true
    
  ppmi:
    window_size: 5
    min_count: 5
    max_vocab_size: 100000
    top_k_expansion: 10
    expansion_weight: 0.5
    
  kg:
    entity_linker: "spacy"
    spacy_model: "en_core_web_lg"
    use_ppr: true
    ppr_alpha: 0.85
    ppr_top_k: 20
    use_owl: true

fusion:
  rrf:
    k: 60
    
  gating:
    type: "sigmoid"  # or "softmax"
    query_dim: 768
    hidden_dim: 64
    dropout: 0.1
    
  cross_attention:
    num_heads: 8
    dropout: 0.1

training:
  gating:
    epochs: 20
    batch_size: 32
    lr: 1.0e-4
    weight_decay: 0.01
    margin: 0.1
    early_stopping_patience: 3
    gradient_clip: 1.0

evaluation:
  ks: [5, 10, 20, 50, 100]
  bootstrap_samples: 1000
  confidence_level: 0.95

hardware:
  device: "cuda"  # or "cpu"
  num_workers: 4

logging:
  wandb:
    project: "rag-second-brain"
    entity: null
  log_interval: 100
  save_interval: 1000
